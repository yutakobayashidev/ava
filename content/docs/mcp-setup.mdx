---
title: AIコーディングエージェントとの連携
description: AvaをClaude Code、Cursor、Windsurfなどに接続する方法
---

## AIコーディングエージェントとは

Claude Code、Cursorなどのコーディングエージェントは、AI技術を使ってコーディング作業を支援してくれるツールです。AvaはMCP（Model Context Protocol）を通じてこれらのツールと連携し、作業の進捗を自動的にSlackに報告します。

<Accordions type="single">
  <Accordion title="MCPとは？">
    **MCP（Model Context Protocol）** は、AIアプリケーションが外部ツールやデータソースと連携するためのオープンな標準プロトコルです。

    MCPを使うことで、Claude CodeなどのAIエージェントが：
    - データベースにアクセスする
    - 外部APIを呼び出す
    - ファイルシステムを操作する
    - カスタムツールを実行する

    などの操作を安全に実行できます。

    **Avaとの関係:**
    - Ava はMCPサーバーとして動作します
    - Claude CodeなどのAIエージェントがMCPクライアントとしてAvaに接続します
    - AIエージェントはAvaが提供するツール（`start_task`、`update_task`など）を使って進捗を報告します

    詳しくは [MCP公式ドキュメント](https://modelcontextprotocol.io/docs/getting-started/intro) をご覧ください。

  </Accordion>
</Accordions>

## 設定方法

<Tabs items={['Claude Code', 'Cursor']} persist groupId="coding-agent">
  <Tab value="Claude Code">
    ### 1. Claude Codeを起動

    お使いのエディタまたはCLIでClaude Codeを起動します。

    ### 2. MCP サーバーを設定

    Avaは**Client ID Metadata Document (CIMD)** に対応しています。これにより、事前のクライアント登録なしで簡単にMCPサーバーに接続できます。

    `.mcp.json` ファイルを作成し、以下を追加：

    ```json
    {
      "mcpServers": {
        "ava": {
          "type": "http",
          "url": "https://ava-dusky-gamma.vercel.app/mcp"
        }
      }
    }
    ```

    **設定ファイルの場所:**
    - プロジェクト固有: プロジェクトルートに `.mcp.json`
    - グローバル: ホームディレクトリに `.mcp.json`

    <Accordions type="single">
      <Accordion title="CIMD（Client ID Metadata Document）とは？">
        **CIMD** は、OAuth 2.1の新しい拡張仕様で、クライアント登録を簡素化する仕組みです。

        **従来の方法（DCR - Dynamic Client Registration）:**
        1. `/api/oauth/register` にクライアント情報を POST
        2. サーバーから `client_id` と `client_secret` を受け取る
        3. これらを設定ファイルに記述

        **CIMDを使った方法:**
        1. クライアントメタデータを公開URLでホスト
        2. そのURL自体を `client_id` として使用
        3. サーバーは自動的にメタデータを取得して検証

        **メリット:**
        - 事前登録が不要
        - PKCE（Proof Key for Code Exchange）で安全に認証
        - ローカル開発やテストが簡単

        Avaは **CIMD と DCR の両方** をサポートしているため、Claude Code などの対応クライアントは自動的にこの仕組みを使って接続します。

        詳しくは [IETF Draft - OAuth Client ID Metadata Document](https://datatracker.ietf.org/doc/draft-ietf-oauth-client-id-metadata-document/) をご覧ください。
      </Accordion>

      <Accordion title="Dynamic Client Registration (DCR) を使いたい場合">
        **DCR（Dynamic Client Registration）** は、OAuth 2.0 の標準仕様で、プログラムから動的にクライアントを登録する仕組みです。

        **使用方法:**

        1. Avaの登録エンドポイントに POST リクエストを送信：

        ```bash
        curl -X POST https://ava-dusky-gamma.vercel.app/api/oauth/register \
          -H "Content-Type: application/json" \
          -d '{
            "client_name": "My Application",
            "redirect_uris": ["https://myapp.example.com/callback"]
          }'
        ```

        2. レスポンスで `client_id` と `client_secret` を取得：

        ```json
        {
          "client_id": "abc123...",
          "client_secret": "xyz789...",
          "redirect_uris": ["https://myapp.example.com/callback"]
        }
        ```

        3. これらの値を `.mcp.json` に設定：

        ```json
        {
          "mcpServers": {
            "ava": {
              "type": "http",
              "url": "https://ava-dusky-gamma.vercel.app/mcp",
              "oauth": {
                "client_id": "abc123...",
                "client_secret": "xyz789..."
              }
            }
          }
        }
        ```

        **注意:**
        - DCR は主に自動化やプログラムからの利用を想定しています
        - 通常のユーザーは CIMD を使った方が簡単です
        - `client_secret` は安全に保管してください
      </Accordion>
    </Accordions>

    ### 3. 初回接続と認証

    Claude CodeからAvaに初めて接続すると、ブラウザが開いて認証画面が表示されます。

    1. ブラウザで「許可」をクリック
    2. 認証が完了すると自動的にClaude Codeに戻ります

    ### 4. 接続の確認

    Claude Codeで以下のように尋ねてみてください：

    ```
    利用可能なMCPツールを教えて
    ```

    以下のツールが表示されれば成功です：
    - `start_task` - タスクを開始
    - `update_task` - 進捗を更新
    - `report_blocked` - 詰まりを報告
    - `complete_task` - タスクを完了
    - `list_tasks` - タスク一覧を表示

    ### 5. Avaスキルをインストール（推奨）

    Avaの使い方をClaude Codeに教えるスキルをインストールすることで、より効果的に使えます。

    Claude Codeで以下のコマンドを実行：

    ```
    /plugin marketplace add yutakobayashidev/ava-skills
    ```

    次に、スキルをインストール：

    ```
    /plugin install ava-mcp-usage@ava-skills
    ```

    **スキルをインストールすると:**
    - Avaの使い方のベストプラクティスが自動的に適用されます
    - 自分で設定を考える手間が省けます（デフォルトプリセット）
    - プライバシーに配慮した報告が自動的に行われます

    もちろん、自分で[Claude Skills](https://support.claude.com/ja/articles/12512176-%E3%82%B9%E3%82%AD%E3%83%AB%E3%81%A8%E3%81%AF%E4%BD%95%E3%81%A7%E3%81%99%E3%81%8B)を作成したり、CLAUDE.mdに独自のルールを追記することで、報告の仕方をカスタマイズすることもできます。

  </Tab>

  <Tab value="Cursor">
    ### 1. Cursorを起動

    Cursorエディタを開きます。

    ### 2. MCP サーバーを設定

    `.cursor/mcp.json` ファイルを作成し、以下を追加：

    ```json
    {
      "mcpServers": {
        "ava": {
          "type": "http",
          "url": "https://ava-dusky-gamma.vercel.app/mcp"
        }
      }
    }
    ```

    **設定ファイルの場所:**
    - プロジェクト固有: `.cursor/mcp.json`（プロジェクトルート）
    - グローバル: `~/.cursor/mcp.json`（ホームディレクトリ）

    ### 3. 設定を反映

    Cursorを再起動するか、コマンドパレット（`Cmd+Shift+P` / `Ctrl+Shift+P`）から「Reload Window」を実行します。

    ### 4. 初回接続と認証

    1. Cursorの設定からMCPの設定画面を開く
    2. Avaサーバーの横にある「Connect」ボタンをクリック
    3. ブラウザが開いて認証画面が表示されます
    4. ブラウザで「許可」をクリック
    5. 認証が完了すると自動的にCursorに戻ります

    ### 5. 接続の確認

    Cursorのチャットで以下のように尋ねてみてください：

    ```
    利用可能なMCPツールを教えて
    ```

    Avaのツール一覧が表示されれば成功です。

  </Tab>
</Tabs>

## 他のMCPツールとの併用

Avaは**進捗の共有とチームへの透明性確保に特化したツール**です。タスク管理自体は、GitHub IssuesやLinearなどの専用サービスを使うことを推奨します。

### おすすめの併用パターン

以下のMCPツールと組み合わせることで、より効率的な開発フローを実現できます：

#### GitHub MCP

GitHubのIssue管理とAvaの進捗報告を組み合わせることで、タスク管理とチームへの透明性を両立できます。

```json
{
  "mcpServers": {
    "ava": {
      "type": "http",
      "url": "https://ava-dusky-gamma.vercel.app/mcp"
    },
    "github": {
      "type": "http",
      "url": "https://api.githubcopilot.com/mcp/"
    }
  }
}
```

**使用例:**

1. GitHub MCPでIssueを取得・作成
2. Avaで作業開始を報告（Issueタイトルを指定）
3. 進捗はAvaが自動でSlackに投稿
4. 完了時、Pull RequestのURLをAvaが報告

#### GitHub CLI（gh）

GitHub CLIを使ってIssueやPull Requestを直接操作することもできます。GitHub CLIはMCPサーバーではありませんが、コーディングエージェントから直接呼び出すことで、タスク管理を効率化できます。

#### Linear MCP

Linearでタスク管理している場合は、Linear MCPとの併用が便利です。

```json
{
  "mcpServers": {
    "ava": {
      "type": "http",
      "url": "https://ava-dusky-gamma.vercel.app/mcp"
    },
    "linear": {
      "command": "npx",
      "args": ["-y", "mcp-remote", "https://mcp.linear.app/mcp"]
    }
  }
}
```

## 次のステップ

設定が完了したら、[使い方ガイド](/docs/usage-guide)で実際の使用方法を確認しましょう。

## トラブルシューティング

接続できない場合は、[トラブルシューティング](/docs/troubleshooting)を確認してください。
